@page "/Loan/{License}"
@using Rental.Data.Context
@inject RentalContext RentalContext

<Navigation></Navigation>

<table class="table">
  <thead>
  <tr>
    <th scope="col">#</th>
    <th scope="col">User</th>
    <th scope="col">Date Start</th>
      <th scope="col">Date End</th>
      <th scope="col">Right Date</th>
  </tr>
  </thead>
  <tbody>
  @foreach (var loan in _loans)
  {
      <tr>
            <th scope="row">@loan.Serial</th>
            <td>@loan.User</td>
            <td>@loan.DateStart</td>
          <td>@loan.DateEnd</td>
          <td>@VerifyDates(@loan.DateStart, @loan.DateEnd)</td>
      </tr>
  }
  </tbody>
</table>

<Footer></Footer>

@code {

    [Parameter]
    public string License { get; set; }
    
    private List<Rental.Data.Loan> _loans;
    
    protected override async Task OnInitializedAsync()
    {
        _loans = await RentalContext.GetLoansByLicense(License);
    }

    private string VerifyDates(DateTime start, DateTime end)
    {
        // Less than zero - This date start is earlier than date end (wrong format).
        if (start.CompareTo(end) < 0)
        {
            return "Wrong";
        }

        return "Right";
    }
}